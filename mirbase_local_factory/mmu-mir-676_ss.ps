%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-1.8.3
%%CreationDate: Tue Jun 10 17:21:43 2014
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint coor length cutpoint sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
     coor exch 1 sub get aload pop moveto
     coor exch 1 sub get aload pop lineto
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
CUUUGCCUGAAUGCAUGACUCUACAACCUUAGGACUUGCAGAAUUAAAGGAAUGCCGUCCUGAGGUUGUUGAGCUGUGCGUUUCUGGGC\
) def
/coor [
[93.950 312.004]
[78.690 316.954]
[65.385 307.989]
[64.242 291.987]
[76.138 281.223]
[78.225 266.368]
[80.313 251.514]
[82.401 236.660]
[83.969 221.743]
[85.015 206.779]
[86.061 191.816]
[87.108 176.852]
[88.154 161.889]
[89.200 146.925]
[90.247 131.962]
[91.293 116.998]
[81.867 105.994]
[82.877 91.540]
[93.743 81.955]
[94.790 66.992]
[95.836 52.028]
[89.080 37.722]
[97.687 25.566]
[98.733 10.602]
[99.779 -4.361]
[100.826 -19.325]
[101.872 -34.288]
[102.918 -49.252]
[103.965 -64.215]
[105.011 -79.179]
[106.057 -94.142]
[107.104 -109.106]
[108.150 -124.069]
[109.196 -139.033]
[110.243 -153.996]
[102.322 -164.356]
[103.635 -176.924]
[112.914 -184.896]
[114.482 -199.814]
[116.050 -214.732]
[103.039 -222.712]
[94.786 -235.551]
[92.930 -250.701]
[97.838 -265.153]
[108.538 -276.038]
[122.903 -281.195]
[138.083 -279.600]
[151.062 -271.569]
[159.265 -258.697]
[161.062 -243.540]
[156.096 -229.107]
[145.354 -218.264]
[130.968 -213.164]
[129.400 -198.246]
[127.832 -183.328]
[135.872 -167.835]
[125.206 -152.950]
[124.160 -137.986]
[123.114 -123.023]
[122.067 -108.059]
[121.021 -93.096]
[119.975 -78.132]
[118.928 -63.169]
[117.882 -48.205]
[116.836 -33.242]
[115.789 -18.279]
[114.743 -3.315]
[113.696 11.648]
[112.650 26.612]
[119.481 39.848]
[110.800 53.075]
[109.753 68.038]
[108.707 83.002]
[118.133 94.006]
[117.123 108.460]
[106.257 118.045]
[105.210 133.008]
[104.164 147.972]
[103.117 162.935]
[102.071 177.899]
[101.025 192.862]
[99.978 207.826]
[98.932 222.789]
[101.622 229.218]
[100.640 235.099]
[97.255 238.748]
[95.167 253.602]
[93.080 268.456]
[90.992 283.310]
] def
/pairs [
[5 89]
[6 88]
[7 87]
[8 86]
[9 83]
[10 82]
[11 81]
[12 80]
[13 79]
[14 78]
[15 77]
[16 76]
[19 73]
[20 72]
[21 71]
[23 69]
[24 68]
[25 67]
[26 66]
[27 65]
[28 64]
[29 63]
[30 62]
[31 61]
[32 60]
[33 59]
[34 58]
[35 57]
[38 55]
[39 54]
[40 53]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
