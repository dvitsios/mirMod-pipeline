%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-1.8.3
%%CreationDate: Tue Jun 10 17:21:45 2014
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint coor length cutpoint sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
     coor exch 1 sub get aload pop moveto
     coor exch 1 sub get aload pop lineto
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
AGCCAUCUCCUAGGCCAGAAGCAUUAACUCUUUGAAUGCUGCUCGUCAAAGAUCUGUUGCAGAGCCUUUGAAUUGAAGCUGCUUUAAAAUUCCAAUGCAAGGGCUGGUGCGAUGGCUCA\
) def
/coor [
[111.106 455.070]
[110.321 440.091]
[109.536 425.111]
[108.751 410.132]
[107.966 395.152]
[107.181 380.173]
[106.396 365.193]
[98.003 352.888]
[105.007 338.702]
[104.026 323.734]
[102.849 308.781]
[101.672 293.827]
[100.495 278.873]
[91.783 266.792]
[98.414 252.427]
[97.237 237.474]
[87.045 232.036]
[80.725 222.221]
[79.978 210.451]
[85.109 199.698]
[94.926 192.735]
[94.533 177.740]
[94.140 162.745]
[93.748 147.750]
[93.355 132.755]
[79.818 126.641]
[70.267 115.266]
[66.589 100.875]
[69.509 86.311]
[78.452 74.451]
[91.650 67.637]
[91.257 52.642]
[90.865 37.648]
[90.472 22.653]
[90.079 7.658]
[89.687 -7.337]
[86.300 -15.956]
[89.485 -22.728]
[89.485 -37.728]
[81.748 -51.529]
[89.485 -64.256]
[89.485 -79.256]
[89.485 -94.256]
[89.289 -109.255]
[77.935 -125.812]
[87.591 -142.480]
[86.414 -157.434]
[85.238 -172.388]
[84.061 -187.342]
[82.884 -202.296]
[81.707 -217.249]
[70.919 -232.101]
[78.937 -247.652]
[77.369 -262.570]
[75.802 -277.487]
[74.234 -292.405]
[66.565 -307.526]
[78.971 -319.081]
[93.509 -310.358]
[89.151 -293.973]
[90.719 -279.055]
[92.287 -264.138]
[93.855 -249.220]
[103.100 -241.299]
[104.464 -228.797]
[96.661 -218.426]
[97.838 -203.472]
[99.014 -188.519]
[100.191 -173.565]
[101.368 -158.611]
[102.545 -143.657]
[110.991 -137.643]
[114.748 -127.741]
[112.319 -117.207]
[104.284 -109.647]
[107.646 -102.961]
[104.485 -94.256]
[104.485 -79.256]
[104.485 -64.256]
[112.223 -51.529]
[104.485 -37.728]
[104.485 -22.728]
[104.682 -7.730]
[105.074 7.265]
[105.467 22.260]
[105.860 37.255]
[106.252 52.250]
[106.645 67.245]
[120.182 73.359]
[129.733 84.734]
[133.411 99.125]
[130.491 113.689]
[121.548 125.549]
[108.350 132.363]
[108.743 147.358]
[109.135 162.352]
[109.528 177.347]
[109.921 192.342]
[124.130 204.724]
[124.893 223.240]
[112.191 236.297]
[113.368 251.251]
[122.164 264.401]
[115.449 277.696]
[116.626 292.650]
[117.803 307.604]
[118.980 322.557]
[122.814 330.988]
[119.987 337.917]
[128.436 351.294]
[121.375 364.408]
[122.160 379.388]
[122.945 394.367]
[123.730 409.347]
[124.515 424.326]
[125.300 439.306]
[126.085 454.285]
[132.952 469.786]
[119.958 480.676]
] def
/pairs [
[1 117]
[2 116]
[3 115]
[4 114]
[5 113]
[6 112]
[7 111]
[9 109]
[10 107]
[11 106]
[12 105]
[13 104]
[15 102]
[16 101]
[21 98]
[22 97]
[23 96]
[24 95]
[25 94]
[31 88]
[32 87]
[33 86]
[34 85]
[35 84]
[36 83]
[38 82]
[39 81]
[41 79]
[42 78]
[43 77]
[44 75]
[46 71]
[47 70]
[48 69]
[49 68]
[50 67]
[51 66]
[53 63]
[54 62]
[55 61]
[56 60]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
