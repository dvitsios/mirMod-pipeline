%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-1.8.3
%%CreationDate: Tue Jun 10 17:21:43 2014
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint coor length cutpoint sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
     coor exch 1 sub get aload pop moveto
     coor exch 1 sub get aload pop lineto
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
UGGAAAGUUCAUUGUUCGACACCAUGGAUCUCCAGGUGGGUCACGUUUAGAUAUACACCAACCUGGAGGACUCCAUGCUGUUGA\
) def
/coor [
[22.573 288.454]
[22.125 303.606]
[16.519 317.689]
[6.431 329.004]
[-6.919 336.184]
[-21.920 338.361]
[-36.761 335.273]
[-49.649 327.293]
[-59.028 315.385]
[-63.765 300.986]
[-63.289 285.835]
[-57.657 271.762]
[-47.549 260.466]
[-34.185 253.311]
[-19.180 251.161]
[-4.345 254.276]
[3.551 241.523]
[11.448 228.770]
[19.344 216.016]
[27.241 203.263]
[35.137 190.510]
[35.259 175.616]
[49.102 167.956]
[56.999 155.203]
[64.895 142.449]
[72.792 129.696]
[80.688 116.943]
[88.585 104.190]
[96.005 91.153]
[102.938 77.852]
[109.871 64.550]
[116.804 51.248]
[123.737 37.947]
[130.670 24.645]
[137.603 11.344]
[144.536 -1.958]
[151.469 -15.260]
[150.986 -31.073]
[163.730 -38.784]
[170.663 -52.085]
[177.596 -65.387]
[177.319 -71.095]
[179.223 -75.771]
[182.481 -78.719]
[186.105 -79.713]
[194.467 -92.166]
[189.004 -106.689]
[193.153 -121.641]
[205.319 -131.273]
[220.824 -131.880]
[233.706 -123.229]
[239.012 -108.647]
[234.701 -93.741]
[222.430 -84.242]
[206.920 -83.803]
[198.557 -71.351]
[190.898 -58.454]
[183.965 -45.152]
[177.032 -31.850]
[178.010 -16.988]
[164.771 -8.327]
[157.838 4.975]
[150.904 18.277]
[143.971 31.578]
[137.038 44.880]
[130.105 58.181]
[123.172 71.483]
[116.239 84.785]
[109.306 98.086]
[109.752 103.578]
[106.954 108.873]
[101.338 112.086]
[93.441 124.839]
[85.545 137.593]
[77.648 150.346]
[69.752 163.099]
[61.856 175.852]
[61.169 191.659]
[47.891 198.406]
[39.994 211.160]
[32.098 223.913]
[24.201 236.666]
[16.305 249.419]
[8.408 262.173]
] def
/pairs [
[16 84]
[17 83]
[18 82]
[19 81]
[20 80]
[21 79]
[23 77]
[24 76]
[25 75]
[26 74]
[27 73]
[28 72]
[29 69]
[30 68]
[31 67]
[32 66]
[33 65]
[34 64]
[35 63]
[36 62]
[37 61]
[39 59]
[40 58]
[41 57]
[45 56]
[46 55]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
