%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-1.8.3
%%CreationDate: Tue Jun 10 17:21:53 2014
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint coor length cutpoint sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
     coor exch 1 sub get aload pop moveto
     coor exch 1 sub get aload pop lineto
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
GGUGGCAGGGCCACAACCAGCGCAGACUGGCGCGCCCCAGGGAUCUCUGGGCGAGUAUCUCUUUGAGCGCCUCACUCUCAAGCACGACUAGGAGGCCUCUGUGCCUUCC\
) def
/coor [
[41.938 283.363]
[28.841 282.202]
[22.222 295.663]
[15.604 309.124]
[8.986 322.585]
[2.367 336.046]
[0.805 352.928]
[-15.850 356.100]
[-23.508 340.974]
[-11.094 329.428]
[-4.475 315.967]
[2.143 302.506]
[8.761 289.045]
[15.380 275.584]
[4.620 262.723]
[0.479 246.418]
[3.820 229.874]
[14.030 216.366]
[29.132 208.588]
[46.167 208.117]
[52.006 194.300]
[57.845 180.483]
[63.684 166.667]
[69.523 152.850]
[75.362 139.033]
[81.201 125.216]
[69.704 108.449]
[70.865 88.152]
[84.198 72.805]
[79.972 58.413]
[75.746 44.021]
[71.520 29.628]
[67.294 15.236]
[46.455 7.523]
[36.652 -12.161]
[42.920 -32.996]
[33.761 -44.875]
[24.601 -56.754]
[15.441 -68.632]
[6.281 -80.511]
[-2.878 -92.389]
[-18.242 -98.125]
[-20.689 -114.341]
[-7.702 -124.355]
[7.359 -117.866]
[9.000 -101.549]
[18.160 -89.670]
[27.320 -77.792]
[36.479 -65.913]
[45.639 -54.035]
[54.799 -42.156]
[58.335 -43.387]
[61.999 -44.159]
[63.709 -59.061]
[65.419 -73.964]
[61.217 -90.389]
[75.837 -98.973]
[88.133 -87.300]
[80.321 -72.254]
[78.611 -57.351]
[76.901 -42.449]
[86.233 -36.801]
[92.906 -28.098]
[95.971 -17.508]
[94.967 -6.471]
[89.991 3.497]
[81.687 11.010]
[85.913 25.402]
[90.139 39.795]
[94.365 54.187]
[98.591 68.579]
[110.116 70.219]
[120.255 75.938]
[127.620 84.954]
[131.201 96.031]
[146.103 97.741]
[161.005 99.450]
[175.907 101.160]
[186.566 93.726]
[199.026 95.551]
[206.602 105.101]
[221.450 107.236]
[235.103 98.811]
[250.153 104.368]
[255.054 119.644]
[246.047 132.920]
[230.042 134.013]
[219.315 122.083]
[204.468 119.948]
[188.639 127.375]
[174.197 116.063]
[159.295 114.353]
[144.393 112.643]
[129.491 110.933]
[124.082 120.231]
[115.856 127.163]
[105.775 130.917]
[95.018 131.055]
[89.179 144.872]
[83.340 158.689]
[77.501 172.506]
[71.662 186.322]
[65.823 200.139]
[59.984 213.956]
[69.508 223.344]
[75.219 235.402]
[76.443 248.654]
[73.053 261.491]
[65.482 272.359]
] def
/pairs [
[2 14]
[3 13]
[4 12]
[5 11]
[6 10]
[20 104]
[21 103]
[22 102]
[23 101]
[24 100]
[25 99]
[26 98]
[29 71]
[30 70]
[31 69]
[32 68]
[33 67]
[36 51]
[37 50]
[38 49]
[39 48]
[40 47]
[41 46]
[53 61]
[54 60]
[55 59]
[75 94]
[76 93]
[77 92]
[78 91]
[81 89]
[82 88]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
