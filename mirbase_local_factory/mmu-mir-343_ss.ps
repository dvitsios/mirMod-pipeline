%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-1.8.3
%%CreationDate: Tue Jun 10 17:21:44 2014
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint coor length cutpoint sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
     coor exch 1 sub get aload pop moveto
     coor exch 1 sub get aload pop lineto
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
UGGGAUAGAGUGGGUGUGGCGGGGGUAGCAGAGCCCAGGGCAACCUCUCCCUUCAUGUGCCCAGAUCCUGCAUGC\
) def
/coor [
[105.342 276.953]
[115.856 265.541]
[112.778 250.860]
[109.699 236.179]
[106.621 221.499]
[103.543 206.818]
[94.972 203.002]
[89.170 195.450]
[87.646 185.908]
[90.901 176.660]
[98.274 169.986]
[97.035 155.038]
[95.796 140.089]
[94.557 125.140]
[93.319 110.191]
[91.463 95.306]
[88.994 80.511]
[86.526 65.716]
[84.057 50.920]
[74.153 38.582]
[79.690 24.754]
[77.221 9.959]
[74.753 -4.836]
[72.284 -19.632]
[69.815 -34.427]
[60.889 -22.372]
[47.494 -15.621]
[32.494 -15.617]
[19.096 -22.361]
[10.163 -34.412]
[7.607 -49.192]
[11.973 -63.543]
[22.328 -74.395]
[36.458 -79.430]
[51.342 -77.570]
[63.798 -69.212]
[71.163 -56.147]
[75.443 -70.524]
[79.723 -84.900]
[75.393 -100.717]
[87.116 -112.184]
[102.834 -107.505]
[106.376 -91.493]
[94.100 -80.620]
[89.820 -66.244]
[85.540 -51.867]
[84.610 -36.896]
[87.079 -22.101]
[89.548 -7.305]
[92.017 7.490]
[94.486 22.286]
[104.212 33.566]
[98.852 48.451]
[101.321 63.247]
[103.790 78.042]
[106.259 92.837]
[109.959 96.992]
[110.898 102.968]
[108.268 108.953]
[109.506 123.901]
[110.745 138.850]
[111.984 153.799]
[113.222 168.748]
[126.725 185.122]
[118.224 203.740]
[121.302 218.421]
[124.380 233.101]
[127.458 247.782]
[130.537 262.463]
[144.749 268.690]
[152.558 282.099]
[150.961 297.534]
[140.571 309.059]
[125.384 312.243]
[111.240 305.862]
] def
/pairs [
[2 69]
[3 68]
[4 67]
[5 66]
[6 65]
[11 63]
[12 62]
[13 61]
[14 60]
[15 59]
[16 56]
[17 55]
[18 54]
[19 53]
[21 51]
[22 50]
[23 49]
[24 48]
[25 47]
[37 46]
[38 45]
[39 44]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
