%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-1.8.3
%%CreationDate: Tue Jun 10 17:21:44 2014
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint coor length cutpoint sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
     coor exch 1 sub get aload pop moveto
     coor exch 1 sub get aload pop lineto
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
UCAUAUAGUAUUAAACCGAACUGUUUUCCUUAUAGACACAAUUUAUUUUUACACACACACACACACACAUAUAUAUAUAUAUGUGUGUGUGUAUGUGUGUAAAUAACAAUGUUAAAAUAGUA\
) def
/coor [
[22.344 319.955]
[22.629 335.049]
[18.831 349.660]
[11.230 362.703]
[0.391 373.211]
[-12.881 380.405]
[-27.603 383.749]
[-42.680 382.997]
[-56.996 378.204]
[-69.486 369.725]
[-79.225 358.190]
[-85.489 344.454]
[-87.815 329.538]
[-86.028 314.548]
[-80.263 300.596]
[-70.946 288.717]
[-58.769 279.794]
[-44.636 274.488]
[-29.595 273.193]
[-14.763 276.005]
[-8.107 262.562]
[-1.451 249.120]
[5.205 235.677]
[11.861 222.235]
[18.516 208.792]
[25.172 195.350]
[31.828 181.907]
[17.385 185.959]
[3.631 179.975]
[-3.251 166.646]
[-0.165 151.967]
[11.501 142.539]
[26.501 142.600]
[38.090 152.124]
[41.055 166.828]
[49.996 154.784]
[58.936 142.739]
[67.876 130.694]
[60.483 120.310]
[56.343 108.254]
[55.796 95.518]
[58.888 83.151]
[65.364 72.171]
[74.691 63.482]
[86.102 57.799]
[98.656 55.590]
[111.321 57.036]
[123.054 62.019]
[132.891 50.694]
[142.727 39.369]
[152.563 28.044]
[162.399 16.719]
[172.235 5.394]
[182.071 -5.930]
[191.907 -17.255]
[201.743 -28.580]
[211.579 -39.905]
[214.787 -55.398]
[228.974 -59.933]
[238.810 -71.258]
[248.646 -82.582]
[258.482 -93.907]
[268.318 -105.232]
[278.154 -116.557]
[287.990 -127.882]
[297.827 -139.207]
[307.663 -150.531]
[317.499 -161.856]
[327.335 -173.181]
[337.171 -184.506]
[347.007 -195.831]
[356.843 -207.156]
[366.679 -218.480]
[369.268 -234.674]
[384.681 -240.275]
[397.063 -229.521]
[393.675 -213.476]
[378.004 -208.644]
[368.168 -197.320]
[358.332 -185.995]
[348.496 -174.670]
[338.660 -163.345]
[328.823 -152.020]
[318.987 -140.695]
[309.151 -129.371]
[299.315 -118.046]
[289.479 -106.721]
[279.643 -95.396]
[269.807 -84.071]
[259.971 -72.746]
[250.135 -61.422]
[240.299 -50.097]
[237.795 -35.414]
[222.904 -30.069]
[213.068 -18.744]
[203.232 -7.419]
[193.396 3.906]
[183.560 15.231]
[173.724 26.555]
[163.887 37.880]
[154.051 49.205]
[144.215 60.530]
[134.379 71.855]
[142.490 87.013]
[144.240 104.115]
[139.366 120.602]
[128.598 134.004]
[113.548 142.315]
[96.470 144.290]
[79.921 139.635]
[70.980 151.679]
[62.040 163.724]
[53.100 175.768]
[45.270 188.563]
[38.615 202.005]
[31.959 215.448]
[25.303 228.890]
[18.647 242.333]
[11.991 255.775]
[5.336 269.218]
[-1.320 282.660]
[9.908 292.752]
] def
/pairs [
[20 121]
[21 120]
[22 119]
[23 118]
[24 117]
[25 116]
[26 115]
[27 114]
[35 113]
[36 112]
[37 111]
[38 110]
[48 103]
[49 102]
[50 101]
[51 100]
[52 99]
[53 98]
[54 97]
[55 96]
[56 95]
[57 94]
[59 92]
[60 91]
[61 90]
[62 89]
[63 88]
[64 87]
[65 86]
[66 85]
[67 84]
[68 83]
[69 82]
[70 81]
[71 80]
[72 79]
[73 78]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
