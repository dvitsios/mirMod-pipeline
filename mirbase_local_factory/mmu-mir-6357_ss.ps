%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-1.8.3
%%CreationDate: Tue Jun 10 17:21:49 2014
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint coor length cutpoint sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
     coor exch 1 sub get aload pop moveto
     coor exch 1 sub get aload pop lineto
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
GUACUUACAAAGGCGCGCUUGUCGGUGUAGGCAGGGGUUGAGAGGGACGUUAGGUAGCAGUCCAUAGGCCCUUUCUUAGCACUGCUCAGGGCUUUCAGGUUGCA\
) def
/coor [
[95.871 353.470]
[95.423 338.476]
[94.974 323.483]
[94.301 308.498]
[93.404 293.525]
[92.507 278.552]
[84.139 272.345]
[80.579 262.318]
[83.269 251.794]
[91.535 244.410]
[91.535 229.410]
[91.535 214.410]
[91.535 199.410]
[91.535 184.410]
[83.798 171.683]
[91.535 157.883]
[79.984 151.009]
[73.321 139.210]
[73.401 125.552]
[80.311 113.644]
[92.317 106.687]
[89.353 99.037]
[93.011 91.254]
[93.908 76.281]
[94.805 61.308]
[95.702 46.335]
[96.599 31.361]
[97.496 16.388]
[98.169 1.403]
[98.618 -13.590]
[99.066 -28.583]
[91.745 -42.609]
[99.860 -55.099]
[100.309 -70.092]
[100.757 -85.085]
[101.206 -100.079]
[101.655 -115.072]
[102.104 -130.065]
[102.552 -145.059]
[91.590 -151.446]
[84.481 -161.867]
[82.553 -174.260]
[86.121 -186.208]
[94.430 -195.407]
[105.820 -200.112]
[107.164 -215.052]
[108.509 -229.991]
[109.854 -244.931]
[110.975 -259.889]
[111.872 -274.862]
[112.769 -289.835]
[104.953 -304.252]
[113.760 -318.086]
[130.130 -317.105]
[137.223 -302.319]
[127.742 -288.938]
[126.845 -273.965]
[125.948 -258.992]
[128.735 -252.013]
[124.793 -243.586]
[123.449 -228.647]
[122.104 -213.707]
[120.759 -198.768]
[134.531 -187.923]
[139.196 -170.866]
[132.750 -154.233]
[117.546 -144.610]
[117.097 -129.616]
[116.648 -114.623]
[116.199 -99.630]
[115.751 -84.637]
[115.302 -69.643]
[114.853 -54.650]
[122.206 -41.697]
[114.060 -28.134]
[113.611 -13.141]
[113.162 1.852]
[116.157 8.745]
[112.469 17.285]
[111.572 32.258]
[110.675 47.232]
[109.778 62.205]
[108.881 77.178]
[107.984 92.151]
[107.311 107.136]
[120.788 117.226]
[125.606 133.185]
[120.075 148.736]
[106.535 157.883]
[114.272 171.683]
[106.535 184.410]
[106.535 199.410]
[106.535 214.410]
[106.535 229.410]
[106.535 244.410]
[117.470 261.214]
[107.480 277.655]
[108.377 292.628]
[109.274 307.601]
[112.962 316.142]
[109.967 323.034]
[110.416 338.028]
[110.865 353.021]
[113.631 372.204]
] def
/pairs [
[1 103]
[2 102]
[3 101]
[4 99]
[5 98]
[6 97]
[10 95]
[11 94]
[12 93]
[13 92]
[14 91]
[16 89]
[21 85]
[23 84]
[24 83]
[25 82]
[26 81]
[27 80]
[28 79]
[29 77]
[30 76]
[31 75]
[33 73]
[34 72]
[35 71]
[36 70]
[37 69]
[38 68]
[39 67]
[45 63]
[46 62]
[47 61]
[48 60]
[49 58]
[50 57]
[51 56]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
