%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-1.8.3
%%CreationDate: Tue Jun 10 17:21:48 2014
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint coor length cutpoint sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
     coor exch 1 sub get aload pop moveto
     coor exch 1 sub get aload pop lineto
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
AUUUUCUUAGUAUCAGUUACAAACAAAAACCGUUUUGUAAGACUUGUUGUUUUUGUUUGUUUUGCUGAUGCAGCCAGAGAAUG\
) def
/coor [
[112.801 354.934]
[112.241 339.944]
[111.680 324.955]
[111.119 309.965]
[110.558 294.976]
[109.997 279.986]
[109.436 264.997]
[95.329 253.620]
[93.743 235.253]
[106.104 221.156]
[104.424 206.250]
[102.745 191.344]
[101.065 176.439]
[99.386 161.533]
[97.706 146.627]
[96.027 131.722]
[94.347 116.816]
[82.457 102.644]
[89.642 85.597]
[86.853 70.859]
[84.064 56.120]
[81.276 41.382]
[78.487 26.643]
[75.698 11.905]
[72.910 -2.834]
[70.121 -17.572]
[67.332 -32.311]
[64.544 -47.049]
[61.755 -61.788]
[58.966 -76.526]
[42.840 -91.878]
[49.476 -112.368]
[44.522 -126.527]
[39.568 -140.685]
[34.614 -154.843]
[21.837 -165.124]
[24.620 -181.285]
[40.099 -186.702]
[52.351 -175.801]
[48.772 -159.797]
[53.726 -145.639]
[58.680 -131.481]
[63.634 -117.323]
[71.821 -115.357]
[78.549 -110.137]
[82.576 -102.525]
[83.118 -93.835]
[80.002 -85.603]
[73.705 -79.315]
[76.494 -64.576]
[79.282 -49.838]
[82.071 -35.099]
[84.860 -20.361]
[87.648 -5.622]
[90.437 9.116]
[93.226 23.855]
[96.014 38.593]
[98.803 53.332]
[101.592 68.070]
[104.380 82.809]
[113.155 88.097]
[117.543 97.356]
[116.079 107.496]
[109.253 115.137]
[110.932 130.042]
[112.612 144.948]
[114.291 159.854]
[115.971 174.759]
[117.650 189.665]
[119.330 204.571]
[121.009 219.476]
[131.814 225.099]
[138.397 235.203]
[139.161 247.116]
[134.026 257.758]
[124.426 264.436]
[124.987 279.425]
[125.548 294.415]
[126.108 309.404]
[126.669 324.394]
[127.230 339.383]
[127.791 354.373]
[130.700 373.535]
] def
/pairs [
[1 82]
[2 81]
[3 80]
[4 79]
[5 78]
[6 77]
[7 76]
[10 71]
[11 70]
[12 69]
[13 68]
[14 67]
[15 66]
[16 65]
[17 64]
[19 60]
[20 59]
[21 58]
[22 57]
[23 56]
[24 55]
[25 54]
[26 53]
[27 52]
[28 51]
[29 50]
[30 49]
[32 43]
[33 42]
[34 41]
[35 40]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
